<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>(Extra) Animated Sprites &mdash; CMPT 166 Fall 2016 1 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="CMPT 166 Fall 2016 1 documentation" href="index.html" />
    <link rel="next" title="Introduction to Image Processing" href="image_processing.html" />
    <link rel="prev" title="(Extra) Making a Car" href="car_demo.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="image_processing.html" title="Introduction to Image Processing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="car_demo.html" title="(Extra) Making a Car"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CMPT 166 Fall 2016 1 documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">(Extra) Animated Sprites</a><ul>
<li><a class="reference internal" href="#storing-images-in-an-arraylist">Storing Images in an ArrayList</a></li>
<li><a class="reference internal" href="#initializing-an-animated-sprite">Initializing an Animated Sprite</a></li>
<li><a class="reference internal" href="#rendering-an-animated-sprite">Rendering an Animated Sprite</a></li>
<li><a class="reference internal" href="#updating-an-animated-sprite">Updating an Animated Sprite</a></li>
<li><a class="reference internal" href="#a-sample-program">A Sample Program</a></li>
<li><a class="reference internal" href="#complete-code">Complete Code</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="car_demo.html"
                        title="previous chapter">(Extra) Making a Car</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="image_processing.html"
                        title="next chapter">Introduction to Image Processing</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="extra-animated-sprites">
<h1>(Extra) Animated Sprites<a class="headerlink" href="#extra-animated-sprites" title="Permalink to this headline">¶</a></h1>
<p>So far all the sprites we&#8217;ve used are single-image sprites. That&#8217;s
because our <code class="docutils literal"><span class="pre">Sprite</span></code> class stores only one image:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">class</span> <span class="nc">Sprite</span> <span class="o">{</span>
  <span class="n">PImage</span> <span class="n">img</span><span class="o">;</span>   <span class="c1">// Sprite stores a single image</span>

  <span class="c1">//  ...</span>

<span class="o">}</span> <span class="c1">// class Sprite</span>
</pre></div>
</div>
<p>If we want our sprite image to change while it is moving, then we&#8217;ll to need
store one image for each frame of animation we want. So in this note we&#8217;ll
create a new class called <code class="docutils literal"><span class="pre">AnimatedSprite</span></code> that stores and displays multiple
images for a sprite.</p>
<div class="section" id="storing-images-in-an-arraylist">
<h2>Storing Images in an ArrayList<a class="headerlink" href="#storing-images-in-an-arraylist" title="Permalink to this headline">¶</a></h2>
<p>The main idea is that instead of storing a single image in a <code class="docutils literal"><span class="pre">PImage</span></code>
variable, we will now store multiple images in an <code class="docutils literal"><span class="pre">ArrayList&lt;PImage&gt;</span></code>:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">class</span> <span class="nc">AnimatedSprite</span> <span class="o">{</span>
   <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">PImage</span><span class="o">&gt;</span> <span class="n">images</span><span class="o">;</span>

   <span class="kt">int</span> <span class="n">currentImage</span><span class="o">;</span>     <span class="c1">// index of the image that will be displayed</span>
   <span class="kt">int</span> <span class="n">playRate</span><span class="o">;</span>         <span class="c1">// speed at which to change currentImage</span>
   <span class="kt">int</span> <span class="n">imageSwitchTimer</span><span class="o">;</span> <span class="c1">// get a new image whenever this is 0</span>

   <span class="c1">// ... rest of the code essentially the same as the Sprite class ...</span>

<span class="o">}</span>
</pre></div>
</div>
<p>We also added three new variables:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">currentImage</span></code> is the index in <code class="docutils literal"><span class="pre">images</span></code> of the current image to
display.</li>
<li><code class="docutils literal"><span class="pre">playRate</span></code> stores the speed of the animation. It is how many
frames must pass (i.e. calls to <code class="docutils literal"><span class="pre">update()</span></code> before <code class="docutils literal"><span class="pre">currentImage</span></code>
is changed. The higher the value of <code class="docutils literal"><span class="pre">playRate</span></code>, the <em>slower</em> the
animation will go.</li>
<li><code class="docutils literal"><span class="pre">imageSwitchTimer</span></code> keeps track of when to change an image. It&#8217;s
initially set to <code class="docutils literal"><span class="pre">playRate</span></code>, and every time <code class="docutils literal"><span class="pre">update()</span></code> is called
<code class="docutils literal"><span class="pre">imageSwitchTimer</span></code> is decremented by 1. When it hits 0,
<code class="docutils literal"><span class="pre">currentImage</span></code> is changed.</li>
</ul>
</div>
<div class="section" id="initializing-an-animated-sprite">
<h2>Initializing an Animated Sprite<a class="headerlink" href="#initializing-an-animated-sprite" title="Permalink to this headline">¶</a></h2>
<p>Here is the constructor for <code class="docutils literal"><span class="pre">AnimatedSprite</span></code>:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">AnimatedSprite</span><span class="o">(</span><span class="kt">int</span> <span class="n">init_playRate</span><span class="o">)</span> <span class="o">{</span>   <span class="c1">// constructor</span>
  <span class="n">images</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">PImage</span><span class="o">&gt;();</span>
  <span class="n">playRate</span> <span class="o">=</span> <span class="n">init_playRate</span><span class="o">;</span>
  <span class="n">imageSwitchTimer</span> <span class="o">=</span> <span class="n">playRate</span><span class="o">;</span>
  <span class="n">currentImage</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

  <span class="n">visible</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
  <span class="n">bouncing</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
  <span class="n">boundingBoxVisible</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The only parameter is an initial play rate so that it knows how frequently to
change the image.</p>
<p>We&#8217;ll add images with <code class="docutils literal"><span class="pre">addImage</span></code>:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kt">void</span> <span class="nf">addImage</span><span class="o">(</span><span class="n">String</span> <span class="n">fname</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">PImage</span> <span class="n">img</span> <span class="o">=</span> <span class="n">loadImage</span><span class="o">(</span><span class="n">fname</span><span class="o">);</span>
  <span class="n">images</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">img</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>
</div>
<p>This is called once for each image we want to add to the sprite.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In practice, it&#8217;s common for multiple sprites to be stored
on a <em>single</em> image file known as a <a class="reference internal" href="glossary.html#term-sprite-sheet"><span class="xref std std-term">sprite sheet</span></a>. For
example, here&#8217;s the sprite sheet (from
<a class="reference external" href="http://sdb.drshnaps.com/display.php?object=8608">http://sdb.drshnaps.com/display.php?object=8608</a>) for the images in
these notes:</p>
<blockquote>
<div><a class="reference internal image-reference" href="_images/marioWalk.png"><img alt="A sprite sheet." class="align-center" src="_images/marioWalk.png" style="width: 320.0px; height: 34.0px;" /></a>
</div></blockquote>
<p>A big advantage of this approach is that there&#8217;s only a single image file
for the sprite. This saves memory, and can also take less time to load
since it requires only one call to <code class="docutils literal"><span class="pre">loadImage</span></code>. Another possible benefit
is that it can be easier for the artist creating the sprites to save them
all side-by-side in a single image instead of saving them in multiple
files.</p>
<p class="last">Accessing the individual sprites is a little bit trickier since you must
index into the image pixels using the <code class="docutils literal"><span class="pre">pixels[]</span></code> array that is part of
every <code class="docutils literal"><span class="pre">PImage</span></code>. We won&#8217;t go into the details of that here.</p>
</div>
</div>
<div class="section" id="rendering-an-animated-sprite">
<h2>Rendering an Animated Sprite<a class="headerlink" href="#rendering-an-animated-sprite" title="Permalink to this headline">¶</a></h2>
<p>Rendering an <code class="docutils literal"><span class="pre">AnimatedSprite</span></code> is almost the same as rendering a single-image
sprite. The only difference is that we assign the image we want rendered to
<code class="docutils literal"><span class="pre">img</span></code> at the beginning of <code class="docutils literal"><span class="pre">render()</span></code>:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kt">void</span> <span class="nf">render</span><span class="o">()</span> <span class="o">{</span>
  <span class="n">PImage</span> <span class="n">img</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">currentImage</span><span class="o">);</span>

  <span class="k">if</span> <span class="o">(</span><span class="n">visible</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pushMatrix</span><span class="o">();</span>

    <span class="c1">// move and rotate the coordinate system</span>
    <span class="n">translate</span><span class="o">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="na">height</span> <span class="o">/</span> <span class="mi">2</span><span class="o">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="na">height</span> <span class="o">/</span> <span class="mi">2</span><span class="o">);</span>
    <span class="n">rotate</span><span class="o">(</span><span class="n">angle</span><span class="o">);</span>

    <span class="c1">// draw the image</span>
    <span class="n">image</span><span class="o">(</span><span class="n">img</span><span class="o">,</span> <span class="o">-</span><span class="n">img</span><span class="o">.</span><span class="na">width</span> <span class="o">/</span> <span class="mi">2</span><span class="o">,</span> <span class="o">-</span><span class="n">img</span><span class="o">.</span><span class="na">height</span> <span class="o">/</span> <span class="mi">2</span><span class="o">);</span>

    <span class="n">popMatrix</span><span class="o">();</span>
  <span class="o">}</span>

  <span class="k">if</span> <span class="o">(</span><span class="n">boundingBoxVisible</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">pushStyle</span><span class="o">();</span>
    <span class="n">noFill</span><span class="o">();</span>
    <span class="n">stroke</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
    <span class="n">rect</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">img</span><span class="o">.</span><span class="na">width</span><span class="o">,</span> <span class="n">img</span><span class="o">.</span><span class="na">height</span><span class="o">);</span>
    <span class="n">popStyle</span><span class="o">();</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>We also make the same change to <code class="docutils literal"><span class="pre">pointInBoundingBox</span></code>:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kt">boolean</span> <span class="nf">pointInBoundingBox</span><span class="o">(</span><span class="kt">float</span> <span class="n">a</span><span class="o">,</span> <span class="kt">float</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">PImage</span> <span class="n">img</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">currentImage</span><span class="o">);</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="na">width</span> <span class="o">&amp;&amp;</span>  <span class="n">b</span> <span class="o">&gt;</span> <span class="n">y</span> <span class="o">&amp;&amp;</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="na">height</span><span class="o">)</span>
    <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
  <span class="k">else</span>
    <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="updating-an-animated-sprite">
<h2>Updating an Animated Sprite<a class="headerlink" href="#updating-an-animated-sprite" title="Permalink to this headline">¶</a></h2>
<p>To update an <code class="docutils literal"><span class="pre">AnimatedSprite</span></code>, we do everything we did for a regular
sprite, plus check to see if we need to change <code class="docutils literal"><span class="pre">currentImage</span></code>:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="kt">void</span> <span class="nf">update</span><span class="o">()</span> <span class="o">{</span>
  <span class="n">x</span> <span class="o">+=</span> <span class="n">dx</span><span class="o">;</span>
  <span class="n">y</span> <span class="o">+=</span> <span class="n">dy</span><span class="o">;</span>
  <span class="n">angle</span> <span class="o">+=</span> <span class="n">spinRate</span><span class="o">;</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">bouncing</span><span class="o">)</span> <span class="n">checkEdgeCollisions</span><span class="o">();</span>

  <span class="c1">// change the image if necessary</span>
  <span class="o">--</span><span class="n">imageSwitchTimer</span><span class="o">;</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">imageSwitchTimer</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">imageSwitchTimer</span> <span class="o">=</span> <span class="n">playRate</span><span class="o">;</span>
    <span class="n">currentImage</span> <span class="o">+=</span> <span class="mi">1</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">currentImage</span> <span class="o">&gt;=</span> <span class="n">images</span><span class="o">.</span><span class="na">size</span><span class="o">())</span> <span class="o">{</span> <span class="c1">// wrap-around to first image if necessary</span>
      <span class="n">currentImage</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">imageSwitchTimer</span></code> is decremented by 1 on every call to
<code class="docutils literal"><span class="pre">update()</span></code>. When it hits 0 (or less), we re-initialize it and then
make <code class="docutils literal"><span class="pre">currentImage</span></code> refer to the next image in <code class="docutils literal"><span class="pre">images</span></code>. If
<code class="docutils literal"><span class="pre">currentImage</span></code> is incremented to a value past the end of <code class="docutils literal"><span class="pre">images</span></code>,
then we set it to 0 (i.e make it &#8220;wrap around&#8221;).</p>
</div>
<div class="section" id="a-sample-program">
<h2>A Sample Program<a class="headerlink" href="#a-sample-program" title="Permalink to this headline">¶</a></h2>
<p>Here&#8217;s a program that makes an animated Mario walk across the screen:</p>
<div class="highlight-java"><div class="highlight"><pre><span class="n">AnimatedSprite</span> <span class="n">mario</span><span class="o">;</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="o">()</span> <span class="o">{</span>
  <span class="n">size</span><span class="o">(</span><span class="mi">500</span><span class="o">,</span> <span class="mi">500</span><span class="o">);</span>

  <span class="c1">// initialize the mario sprite</span>
  <span class="n">mario</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AnimatedSprite</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="mi">25</span><span class="o">;</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">y</span> <span class="o">=</span> <span class="mi">25</span><span class="o">;</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">dx</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">visible</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">bouncing</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="s">&quot;marioWalk1.png&quot;</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="s">&quot;marioWalk2.png&quot;</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="s">&quot;marioWalk3.png&quot;</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="s">&quot;marioWalk4.png&quot;</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="s">&quot;marioWalk5.png&quot;</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="s">&quot;marioWalk6.png&quot;</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="s">&quot;marioWalk7.png&quot;</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="s">&quot;marioWalk8.png&quot;</span><span class="o">);</span>
<span class="o">}</span>

<span class="kt">void</span> <span class="nf">draw</span><span class="o">()</span> <span class="o">{</span>
  <span class="n">background</span><span class="o">(</span><span class="mi">255</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">render</span><span class="o">();</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">update</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>
</div>
<p>It uses these image files: <a class="reference download internal" href="_downloads/marioWalk1.png" download=""><code class="xref download docutils literal"><span class="pre">marioWalk1.png</span></code></a>, <a class="reference download internal" href="_downloads/marioWalk2.png" download=""><code class="xref download docutils literal"><span class="pre">marioWalk2.png</span></code></a>, <a class="reference download internal" href="_downloads/marioWalk3.png" download=""><code class="xref download docutils literal"><span class="pre">marioWalk3.png</span></code></a>, <a class="reference download internal" href="_downloads/marioWalk4.png" download=""><code class="xref download docutils literal"><span class="pre">marioWalk4.png</span></code></a>, <a class="reference download internal" href="_downloads/marioWalk5.png" download=""><code class="xref download docutils literal"><span class="pre">marioWalk5.png</span></code></a>, <a class="reference download internal" href="_downloads/marioWalk6.png" download=""><code class="xref download docutils literal"><span class="pre">marioWalk6.png</span></code></a>, <a class="reference download internal" href="_downloads/marioWalk7.png" download=""><code class="xref download docutils literal"><span class="pre">marioWalk7.png</span></code></a>, and <a class="reference download internal" href="_downloads/marioWalk8.png" download=""><code class="xref download docutils literal"><span class="pre">marioWalk8.png</span></code></a>.</p>
</div>
<div class="section" id="complete-code">
<h2>Complete Code<a class="headerlink" href="#complete-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-java"><div class="highlight"><pre><span class="kd">class</span> <span class="nc">AnimatedSprite</span> <span class="o">{</span>
  <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">PImage</span><span class="o">&gt;</span> <span class="n">images</span><span class="o">;</span>
  <span class="kt">int</span> <span class="n">currentImage</span><span class="o">;</span>     <span class="c1">// index of the image that will be displayed</span>
  <span class="kt">int</span> <span class="n">playRate</span><span class="o">;</span>         <span class="c1">// speed at which to change currentImage</span>
  <span class="kt">int</span> <span class="n">imageSwitchTimer</span><span class="o">;</span> <span class="c1">// get a new image whenever this is 0</span>

  <span class="kt">float</span> <span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">;</span>
  <span class="kt">float</span> <span class="n">dx</span><span class="o">,</span> <span class="n">dy</span><span class="o">;</span>
  <span class="kt">float</span> <span class="n">angle</span><span class="o">;</span>
  <span class="kt">float</span> <span class="n">spinRate</span><span class="o">;</span>

  <span class="kt">boolean</span> <span class="n">visible</span><span class="o">;</span>
  <span class="kt">boolean</span> <span class="n">bouncing</span><span class="o">;</span>
  <span class="kt">boolean</span> <span class="n">boundingBoxVisible</span><span class="o">;</span>

  <span class="n">AnimatedSprite</span><span class="o">(</span><span class="kt">int</span> <span class="n">init_playRate</span><span class="o">)</span> <span class="o">{</span>   <span class="c1">// constructor</span>
    <span class="n">images</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">PImage</span><span class="o">&gt;();</span>
    <span class="n">playRate</span> <span class="o">=</span> <span class="n">init_playRate</span><span class="o">;</span>
    <span class="n">imageSwitchTimer</span> <span class="o">=</span> <span class="n">playRate</span><span class="o">;</span>
    <span class="n">currentImage</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="n">visible</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="n">bouncing</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
    <span class="n">boundingBoxVisible</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
  <span class="o">}</span>

  <span class="kt">void</span> <span class="nf">addImage</span><span class="o">(</span><span class="n">String</span> <span class="n">fname</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">PImage</span> <span class="n">img</span> <span class="o">=</span> <span class="n">loadImage</span><span class="o">(</span><span class="n">fname</span><span class="o">);</span>
    <span class="n">images</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">img</span><span class="o">);</span>
  <span class="o">}</span>

  <span class="kt">void</span> <span class="nf">render</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">PImage</span> <span class="n">img</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">currentImage</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">visible</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">pushMatrix</span><span class="o">();</span>

      <span class="c1">// move and rotate the coordinate system</span>
      <span class="n">translate</span><span class="o">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="na">height</span> <span class="o">/</span> <span class="mi">2</span><span class="o">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="na">height</span> <span class="o">/</span> <span class="mi">2</span><span class="o">);</span>
      <span class="n">rotate</span><span class="o">(</span><span class="n">angle</span><span class="o">);</span>

      <span class="c1">// draw the image</span>
      <span class="n">image</span><span class="o">(</span><span class="n">img</span><span class="o">,</span> <span class="o">-</span><span class="n">img</span><span class="o">.</span><span class="na">width</span> <span class="o">/</span> <span class="mi">2</span><span class="o">,</span> <span class="o">-</span><span class="n">img</span><span class="o">.</span><span class="na">height</span> <span class="o">/</span> <span class="mi">2</span><span class="o">);</span>

      <span class="n">popMatrix</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="k">if</span> <span class="o">(</span><span class="n">boundingBoxVisible</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">pushStyle</span><span class="o">();</span>
      <span class="n">noFill</span><span class="o">();</span>
      <span class="n">stroke</span><span class="o">(</span><span class="mi">255</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
      <span class="n">rect</span><span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">img</span><span class="o">.</span><span class="na">width</span><span class="o">,</span> <span class="n">img</span><span class="o">.</span><span class="na">height</span><span class="o">);</span>
      <span class="n">popStyle</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kt">void</span> <span class="nf">update</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">x</span> <span class="o">+=</span> <span class="n">dx</span><span class="o">;</span>
    <span class="n">y</span> <span class="o">+=</span> <span class="n">dy</span><span class="o">;</span>
    <span class="n">angle</span> <span class="o">+=</span> <span class="n">spinRate</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">bouncing</span><span class="o">)</span> <span class="n">checkEdgeCollisions</span><span class="o">();</span>

    <span class="c1">// change the image if necessary</span>
    <span class="o">--</span><span class="n">imageSwitchTimer</span><span class="o">;</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">imageSwitchTimer</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">imageSwitchTimer</span> <span class="o">=</span> <span class="n">playRate</span><span class="o">;</span>
      <span class="n">currentImage</span> <span class="o">+=</span> <span class="mi">1</span><span class="o">;</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">currentImage</span> <span class="o">&gt;=</span> <span class="n">images</span><span class="o">.</span><span class="na">size</span><span class="o">())</span> <span class="o">{</span> <span class="c1">// wrap-around to first image if necessary</span>
        <span class="n">currentImage</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="kt">void</span> <span class="nf">checkEdgeCollisions</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="n">dy</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>       <span class="c1">// hit the top edge?</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="n">height</span><span class="o">)</span> <span class="n">dy</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span> <span class="c1">// hit the bottom edge?</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span> <span class="n">dx</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>       <span class="c1">// hit the left edge?</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">width</span><span class="o">)</span> <span class="n">dx</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>  <span class="c1">// hit the right edge?</span>
  <span class="o">}</span>

  <span class="c1">// Returns true when point (a, b) is inside this sprite&#39;s</span>
  <span class="c1">// bounding box, and false otherwise.</span>
  <span class="kt">boolean</span> <span class="nf">pointInBoundingBox</span><span class="o">(</span><span class="kt">float</span> <span class="n">a</span><span class="o">,</span> <span class="kt">float</span> <span class="n">b</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">PImage</span> <span class="n">img</span> <span class="o">=</span> <span class="n">images</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">currentImage</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">x</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="na">width</span> <span class="o">&amp;&amp;</span>  <span class="n">b</span> <span class="o">&gt;</span> <span class="n">y</span> <span class="o">&amp;&amp;</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="n">y</span> <span class="o">+</span> <span class="n">img</span><span class="o">.</span><span class="na">height</span><span class="o">)</span>
      <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="k">else</span>
      <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
  <span class="o">}</span>
<span class="o">}</span> <span class="c1">// class AnimatedSprite</span>

<span class="c1">///////////////////////////////////////////////////////////////////</span>

<span class="n">AnimatedSprite</span> <span class="n">mario</span><span class="o">;</span>

<span class="kt">void</span> <span class="nf">setup</span><span class="o">()</span> <span class="o">{</span>
  <span class="n">size</span><span class="o">(</span><span class="mi">500</span><span class="o">,</span> <span class="mi">500</span><span class="o">);</span>

  <span class="c1">// initialize the mario sprite</span>
  <span class="n">mario</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AnimatedSprite</span><span class="o">(</span><span class="mi">10</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">x</span> <span class="o">=</span> <span class="mi">25</span><span class="o">;</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">y</span> <span class="o">=</span> <span class="mi">25</span><span class="o">;</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">dx</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">visible</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">bouncing</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="s">&quot;marioWalk1.png&quot;</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="s">&quot;marioWalk2.png&quot;</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="s">&quot;marioWalk3.png&quot;</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="s">&quot;marioWalk4.png&quot;</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="s">&quot;marioWalk5.png&quot;</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="s">&quot;marioWalk6.png&quot;</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="s">&quot;marioWalk7.png&quot;</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">addImage</span><span class="o">(</span><span class="s">&quot;marioWalk8.png&quot;</span><span class="o">);</span>
<span class="o">}</span>

<span class="kt">void</span> <span class="nf">draw</span><span class="o">()</span> <span class="o">{</span>
  <span class="n">background</span><span class="o">(</span><span class="mi">255</span><span class="o">);</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">render</span><span class="o">();</span>
  <span class="n">mario</span><span class="o">.</span><span class="na">update</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="image_processing.html" title="Introduction to Image Processing"
             >next</a> |</li>
        <li class="right" >
          <a href="car_demo.html" title="(Extra) Making a Car"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">CMPT 166 Fall 2016 1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Toby Donaldson.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
  </body>
</html>